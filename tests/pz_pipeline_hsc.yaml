description: |
  Photo-z madness
tasks:
  pz_trainz:
    class: lsst.meas.pz.estimate_pz_task.EstimatePZTask
    config:
      connections.pzModel: 'pzModel_trainz'
      connections.pzEnsemble: 'pz_estimate_trainz'
      python: |
         from lsst.meas.pz.estimate_pz_task_trainz import EstimatePZTrainZTask
         config.pz_algo.retarget(EstimatePZTrainZTask)
         config.pz_algo.stage_name='trainz'
         config.pz_algo.output_mode='return'
         config.pz_algo.band_a_env=dict(i=2.06)
  pz_knn:
    class: lsst.meas.pz.estimate_pz_task.EstimatePZTask
    config:
      connections.pzModel: 'pzModel_knn'
      connections.pzEnsemble: 'pz_estimate_knn'
      python: |
         from lsst.meas.pz.estimate_pz_task_knn import EstimatePZKNNTask
         config.pz_algo.retarget(EstimatePZKNNTask)
         config.pz_algo.stage_name='knn'
         config.pz_algo.output_mode='return'
         config.pz_algo.bands=['mag_g_lsst','mag_r_lsst','mag_i_lsst','mag_z_lsst','mag_y_lsst']
         config.pz_algo.ref_band='mag_i_lsst'
         config.pz_algo.band_a_env=dict(g=3.64,r=2.70,i=2.06,z=1.58,y=1.31)
subsets:
  all_pz:
    subset:
      - pz_trainz
      - pz_knn
    description: |
      All of the photoz algorithms
# run me with
# pipetask run
#  -b $CI_HSC_GEN3_DIR/DATA
#  -i HSC/runs/ci_hsc
#  -o u/echarles/pz_rail_testing
#  -p "${MEAS_PZ_DIR}/tests/pz_pipeline.yaml"
#  -d "skymap='discrete/ci_hsc' AND tract=0 AND patch=69"
